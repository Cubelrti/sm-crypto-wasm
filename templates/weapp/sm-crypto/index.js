"use strict";let e=null;function a(){const r="sm-crypto/workers/sm-crypto.js";return new Promise((t,o)=>{var c;try{e=wx.createWorker(r,{useExperimentalWorker:!0}),e.onMessage(({id:n,event:i})=>{n===-1&&i==="ready"&&(console.log("[sm-crypto] worker ready"),t())}),(c=e.onProcessKilled)==null||c.call(e,console.log)}catch(n){console.warn(n),e.terminate(),o(n)}})}let p=0;function m(r,...t){return new Promise((o,c)=>{const n=p++,i=Date.now();t=t.map(s=>s instanceof Uint8Array?s.buffer:s),e.postMessage({id:n,method:r,args:t}),e.onMessage(({id:s,result:u})=>{if(s===n){const l=Date.now();console.log(`[sm-crypto] perf: ${r} took ${l-i}ms`),o(u)}})})}function f(){return m("sm3")}function y(){return m("sm2_encrypt")}function d(r,t,o){return m("sm4_encrypt",r,t,o)}const w={initSMCrypto:a,sm2:y,sm3:f,sm4:d};module.exports=w;
