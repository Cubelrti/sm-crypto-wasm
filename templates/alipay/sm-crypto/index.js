"use strict";let e=null;function u(){const o="sm-crypto/workers/sm-crypto.js";return new Promise((r,n)=>{var s;try{e=my.createWorker(o,{useExperimentalWorker:!0}),e.onMessage(({id:t,event:c})=>{t===-1&&c==="ready"&&(console.log("[sm-crypto] worker ready"),r())}),(s=e.onProcessKilled)==null||s.call(e,console.log)}catch(t){console.warn(t),e.terminate(),n(t)}})}let p=0;function i(o,...r){return new Promise((n,s)=>{const t=p++,c=Date.now();e.postMessage({id:t,method:o,args:r}),e.onMessage(({id:m,result:a})=>{if(m===t){const l=Date.now();console.log(`[sm-crypto] perf: ${o} took ${l-c}ms`),n(a)}})})}function y(){return i("sm3")}function d(){return i("sm2_encrypt")}function f(o,r,n){return i("sm4_encrypt",o,r,n)}const g={initSMCrypto:u,sm2:d,sm3:y,sm4:f};module.exports=g;
