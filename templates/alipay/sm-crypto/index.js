"use strict";let e=null;function a(){const r="sm-crypto/workers/sm-crypto.js";return console.log("init smcrypto worker"),new Promise((t,n)=>{var c;try{e=my.createWorker(r,{useExperimentalWorker:!0}),e.onMessage(({id:o,event:i})=>{o===-1&&i==="ready"&&(console.log("[sm-crypto] worker ready"),t())}),(c=e.onProcessKilled)==null||c.call(e,console.log)}catch(o){console.warn(o),e.terminate(),n(o)}})}let p=0;function m(r,...t){return new Promise((n,c)=>{const o=p++,i=Date.now();t=t.map(s=>s instanceof Uint8Array?s.buffer:s),e.postMessage({id:o,method:r,args:t}),e.onMessage(({id:s,result:l})=>{if(s===o){const u=Date.now();console.log(`[sm-crypto] perf: ${r} took ${u-i}ms`),n(l)}})})}function y(){return m("sm3")}function f(){return m("sm2_encrypt")}function d(r,t,n){return m("sm4_encrypt",r,t,n)}const k={initSMCrypto:a,sm2:f,sm3:y,sm4:d};module.exports=k;
