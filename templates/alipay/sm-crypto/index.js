"use strict";let e=null;function a(){const t="sm-crypto/workers/sm-crypto.js";return console.log("init smcrypto worker"),new Promise((r,n)=>{var c;try{e=my.createWorker(t,{useExperimentalWorker:!0}),e.onMessage(({id:o,event:i})=>{o===-1&&i==="ready"&&(console.log("[sm-crypto] worker ready"),r())}),(c=e.onProcessKilled)==null||c.call(e,console.log)}catch(o){console.warn(o),e.terminate(),n(o)}})}let p=0;function m(t,...r){return new Promise((n,c)=>{const o=p++,i=Date.now();r=r.map(s=>s instanceof Uint8Array?s.buffer:s),e.postMessage({id:o,method:t,args:r}),e.onMessage(({id:s,result:l})=>{if(s===o){const u=Date.now();console.log(`[sm-crypto] perf: ${t} took ${u-i}ms`),n(l)}})})}function y(){return m("sm3")}function f(){return m("sm2_encrypt")}function d(t,r,n){return m("sm4_encrypt",t,r,n)}const k={initSMCrypto:a,sm2:f,sm3:y,sm4:d};module.exports=k;
